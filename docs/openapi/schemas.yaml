Id:
  type: string
  format: uuid
  readOnly: true
DateTime:
  type: string
  format: date-time
DeliveryType:
  type: string
  enum:
    - 'aem_edge'
    - 'aem_cs'
    - 'other'
AuditType:
  type: string
  enum:
    - '404'
    - 'apex'
    - 'cwv'
    - 'lhs'
    - 'lhs-desktop'
    - 'lhs-mobile'
URL:
  type: string
  format: url
Site:
  type: object
  properties:
    id:
      description: The site ID in uuid format
      $ref: '#/Id'
    organizationId:
      description: The optional ID of the organization this site belongs to
      $ref: '#/Id'
    baseURL:
      description: The base URL of the site
      $ref: '#/URL'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    gitHubURL:
      description: The optional GitHub URL of the site
      $ref: '#/URL'
    isLive:
      description: Whether the site is live or not
      type: boolean
    isLiveToggledAt:
      description: The date and time when the site was last toggled to live or non-live
      $ref: '#/DateTime'
    auditConfig:
      description: The audit configuration for this site
      $ref: '#/AuditConfig'
    createdAt:
      description: The date and time when the site was created
      $ref: '#/DateTime'
    updatedAt:
      description: The date and time when the site was last updated
      $ref: '#/DateTime'
SiteWithLatestAudit:
  allOf:
    - $ref: '#/Site'
    - type: object
      properties:
        audits:
          description: An array with the latest audit for the given audit type
          type: array
          items:
            $ref: '#/Audit'
SiteList:
  type: array
  items:
    $ref: './schemas.yaml#/Site'
SiteCreate:
  type: object
  required:
    - baseURL
    - deliveryType
  properties:
    organizationId:
      description: The optional ID of the organization this site belongs to
      default: null
      $ref: '#/Id'
    baseURL:
      description: The base URL of the site
      $ref: '#/URL'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    gitHubURL:
      description: The optional GitHub URL of the site
      $ref: '#/URL'
    isLive:
      description: Whether the site is live or not.
      default: false
      type: boolean
    auditConfig:
      description: The audit configuration for this site
      $ref: '#/AuditConfig'
SiteUpdate:
  type: object
  properties:
    organizationId:
      description: The optional ID of the organization this site belongs to
      $ref: '#/Id'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    isLive:
      description: Whether the site is live or not.
      type: boolean
    auditConfig:
      description: The audit configuration for this site
      $ref: '#/AuditConfig'
AuditConfigType:
  type: object
  properties:
    disabled:
      description: Whether audits are disabled for the given audit type
      type: boolean
AuditConfig:
  type: object
  properties:
    auditsDisabled:
      description: Whether audits are disabled for this site
      type: boolean
    auditTypeConfigs:
      type: object
      additionalProperties:
        $ref: '#/AuditConfigType'
Audit:
  type: object
  readOnly: true
  properties:
    siteId:
      description: The ID of the site this audit belongs to
      $ref: '#/Id'
    auditedAt:
      description: The date and time of the audit in ISO 8601 format
      $ref: '#/DateTime'
    expiresAt:
      description: The date and time when the audit expires in ISO 8601 format
      $ref: '#/DateTime'
    auditType:
      description: The type of the audit
      $ref: '#/AuditType'
    isError:
      type: boolean
    isLive:
      type: boolean
    fullAuditRef:
      description: |
        A reference by which the full external result of an audit can be accessed, which is dependent on the audit type.
      type: string
    auditResult:
      $ref: '#/AuditResult'
    previousAuditResult:
      $ref: '#/AuditResult'
AuditResult:
  type: object
  description: |
    The result of an audit, which is dependent on the audit type.
  additionalProperties: true
AuditList:
  type: array
  items:
    $ref: './schemas.yaml#/Audit'
