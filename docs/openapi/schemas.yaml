Id:
  type: string
  format: uuid
  readOnly: true
  example: '123e4567-e89b-12d3-a456-426614174000'
DateTime:
  type: string
  format: date-time
  example: '2024-01-19T14:20:30Z'
DeliveryType:
  type: string
  enum:
    - 'aem_edge'
    - 'aem_cs'
    - 'other'
  example: 'aem_edge'
AuditType:
  type: string
  enum:
    - '404'
    - 'apex'
    - 'cwv'
    - 'lhs'
    - 'lhs-desktop'
    - 'lhs-mobile'
    - 'broken-backlinks'
    - 'canonical'
    - 'sitemap'
    - 'structured-data'
    - 'costs'
  example: 'cwv'
URL:
  type: string
  format: url
  example: 'https://www.example.com'
Domain:
  type: string
  format: domain
  example: 'www.example.com'
ImsOrganizationId:
  type: string
  example: '1234567890ABCDEF12345678@AdobeOrg'
ImsUserAccessToken:
  type: string
  example: 'eyJhbGciOiJIUzI1NiJ9.eyJpZCI6IjEyMzQ1IiwidHlwZSI6ImFjY2Vzc190b2tlbiIsImNsaWVudF9pZCI6ImV4YW1wbGVfYXBwIiwidXNlcl9pZCI6Ijk4NzY1NDc4OTBBQkNERUYxMjM0NTY3OEBhYmNkZWYxMjM0NTY3ODkuZSIsImFzIjoiaW1zLW5hMSIsImFhX2lkIjoiMTIzNDU2Nzg5MEFCQ0RFRjEyMzQ1Njc4QGFkb2JlLmNvbSIsImNyZWF0ZWRfYXQiOiIxNzEwMjQ3MDAwMDAwIn0.MRDpxgxSHDj4DmA182hPnjMAnKkly-VUJ_bXpQ-J8EQ'
EmailAddress:
  type: string
  format: email
  example: 'user@example.com'
SlackMentionConfig:
  type: object
  properties:
    slack:
      type: array
      items:
        type: string
HandlerConfig:
  type: object
  additionalProperties: false
  properties:
    mentions:
      $ref: '#/SlackMentionConfig'
    excludedURLs:
      description: URLs to be excluded from the handler's processing
      type: array
      items:
        type: string
        format: uri
  patternProperties:
    "^(404|broken-backlinks)$":
      type: object
      properties:
        mentions:
          $ref: '#/SlackMentionConfig'
        # Define other properties specific to the alert type here
SlackConfig:
  type: object
  additionalProperties: true
  properties:
    channel:
      description: The Slack channel ID to send notifications to
      type: string
      example: 'C1234567890'
    workspace:
      description: The Slack workspace name to send notifications to
      type: string
      example: 'example-workspace'
    invitedUserCount:
      description: The number of external users invited to the Slack channel
      type: integer
      example: 5
    channel-url:
      description: Slack URL of the channel to send notifications to
      type: string
      example: 'https://example-workspace.slack.com/archives/C1234567890'
Config:
  type: object
  additionalProperties: true
  properties:
    slack:
      description: Optional. The Slack configuration
      $ref: '#/SlackConfig'
    handlers:
      description: Optional. The Alert configuration
      $ref: '#/HandlerConfig'
OrganizationConfig:
  allOf:
    - $ref: '#/Config'
SiteConfig:
  allOf:
    - $ref: '#/Config'
Organization:
  type: object
  properties:
    id:
      description: The organization ID in uuid format
      $ref: '#/Id'
    name:
      description: The name of the organization
      type: string
    imsOrgId:
      description: Optional. The ID of the Adobe IMS organization
      $ref: '#/ImsOrganizationId'
    config:
      description: Optional. The configuration of the organization
      $ref: '#/OrganizationConfig'
    createdAt:
      description: The date and time when the organization was created
      $ref: '#/DateTime'
    updatedAt:
      description: The date and time when the organization was last updated
      $ref: '#/DateTime'
  example:
    id: 'o1p2q3r4-s5t6-u7v8-w9x0-yz12x34y56z'
    name: 'Example Organization'
    imsOrgId: '1234567890ABCDEF12345678@AdobeOrg'
    config:
      slack:
        channel: '#example-channel'
        workspace: 'example-workspace'
        invitedUserCount: 5
      handlers:
        '404':
          byOrg: true
          mentions:
            slack:
              - '@user1'
              - '@user2'
        'cwv':
          byOrg: false
          mentions:
            slack:
              - '@user5'
              - '@user6'
    createdAt: '2023-12-15T09:30:00Z'
    updatedAt: '2024-01-19T11:20:00Z'
OrganizationList:
  type: array
  items:
    $ref: './schemas.yaml#/Organization'
OrganizationCreate:
  type: object
  required:
    - name
  properties:
    name:
      description: The name of the organization
      type: string
    imsOrgId:
      description: Optional. The ID of the Adobe IMS organization
      $ref: '#/ImsOrganizationId'
    config:
      description: Optional. The configuration of the organization
      $ref: '#/OrganizationConfig'
  example:
    name: 'Example Organization'
    imsOrgId: '1234567890ABCDEF12345678@AdobeOrg'
    config:
      slack:
        channel: '#example-channel'
        workspace: 'example-workspace'
      handlers:
        '404':
          mentions:
            slack:
              - '@user3'
              - '@user4'
        'cwv':
          byOrg: false
          mentions:
            slack:
              - '@user5'
              - '@user6'
OrganizationUpdate:
  type: object
  properties:
    name:
      description: The name of the organization
      type: string
    imsOrgId:
      description: Optional. The ID of the Adobe IMS organization
      $ref: '#/ImsOrganizationId'
    config:
      description: Optional. The configuration of the organization
      $ref: '#/OrganizationConfig'
  example:
    name: 'Example Organization'
    imsOrgId: '1234567890ABCDEF12345678@AdobeOrg'
    config:
      slack:
        channel: '#example-channel'
        workspace: 'example-workspace'
        handlers:
          '404':
            mentions:
              slack:
                - '@user3'
                - '@user4'
          'cwv':
            mentions:
              slack:
                - '@user5'
                - '@user6'
Site:
  type: object
  properties:
    id:
      description: The site ID in uuid format
      $ref: '#/Id'
    organizationId:
      description: The optional ID of the organization this site belongs to
      $ref: '#/Id'
    baseURL:
      description: The base URL of the site
      $ref: '#/URL'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    gitHubURL:
      description: The optional GitHub URL of the site
      $ref: '#/URL'
    goLiveDate:
      description: The date and time when the site went live on AEM Edge
      nullable: true
      $ref: '#/DateTime'
    config:
      description: Optional. The configuration of the site. May override the organization configuration.
      $ref: '#/SiteConfig'
    createdAt:
      description: The date and time when the site was created
      $ref: '#/DateTime'
    updatedAt:
      description: The date and time when the site was last updated
      $ref: '#/DateTime'
  example:
    id: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    organizationId: 'o1p2q3r4-s5t6-u7v8-w9x0-yz12x34y56z'
    baseURL: 'https://example-site.com'
    deliveryType: 'aem_edge'
    gitHubURL: 'https://github.com/example/repo'
    goLiveDate: '2024-01-20T10:00:00Z'
    config:
      slack:
        channel: 'C1234567890'
        workspace: 'example-workspace'
      handlers:
        '404':
          mentions:
            slack:
              - '@user1'
              - '@user2'
        'broken-backlinks':
          mentions:
            slack:
              - '@user5'
              - '@user6'
          excludedURLs:
            description: URLs to be excluded from the alert
            type: array
            items:
              type: string
              format: uri'
    createdAt: '2023-12-15T09:30:00Z'
    updatedAt: '2024-01-19T11:20:00Z'
SiteWithLatestAudit:
  allOf:
    - $ref: '#/Site'
    - type: object
      properties:
        audits:
          description: An array with the latest audit for the given audit type
          type: array
          items:
            $ref: '#/Audit'
  example:
    id: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    organizationId: 'o1p2q3r4-s5t6-u7v8-w9x0-yz12x34y56z'
    baseURL: 'https://example-site.com'
    deliveryType: 'aem_edge'
    gitHubURL: 'https://github.com/example/repo'
    goLiveDate: '2024-01-20T10:00:00Z'
    createdAt: '2023-12-15T09:30:00Z'
    updatedAt: '2024-01-19T11:20:00Z'
    audits:
      - siteId: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
        auditedAt: '2024-01-20T12:00:00Z'
        expiresAt: '2024-07-20T12:00:00Z'
        auditType: 'cwv'
        isError: false
        deliveryType: 'aem_edge'
        fullAuditRef: 'https://some-audit-system/full-report/1234'
        auditResult:
          someProperty: 'someValue'
        previousAuditResult:
          someProperty: 'somePreviousValue'
SiteList:
  type: array
  items:
    $ref: './schemas.yaml#/Site'
SiteWithLatestAuditList:
  type: array
  items:
    $ref: './schemas.yaml#/SiteWithLatestAudit'
SiteCreate:
  type: object
  required:
    - baseURL
    - deliveryType
  properties:
    organizationId:
      description: The optional ID of the organization this site belongs to
      default: null
      $ref: '#/Id'
    baseURL:
      description: The base URL of the site
      $ref: '#/URL'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    gitHubURL:
      description: The optional GitHub URL of the site
      $ref: '#/URL'
    goLiveDate:
      description: The date and time when the site went live on AEM Edge
      nullable: true
      $ref: '#/DateTime'
  example:
    organizationId: 'o1p2q3r4-s5t6-u7v8-w9x0-yz12x34y56z'
    baseURL: 'https://www.newsite.com'
    deliveryType: 'aem_cs'
SiteUpdate:
  type: object
  properties:
    organizationId:
      description: The optional ID of the organization this site belongs to
      $ref: '#/Id'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    goLiveDate:
      description: The date and time when the site went live on AEM Edge
      nullable: true
      $ref: '#/DateTime'
    config:
      description: Optional. The configuration of the site
      $ref: '#/SiteConfig'
  example:
    organizationId: 'u7y6t5r4-e3w2-x1z0-z9y8-x7v6w5u4t3s2'
    deliveryType: 'other'
    goLiveDate: '2024-01-20T10:00:00Z'
UpdateHandlerTypeConfig:
  type: object
  properties:
    excludedURLs:
      description: Set of urls to exclude. If empty, will remove previously excluded URLs.
      type: array
      items:
        type: string
  example:
    excludedURLs:
      - 'https://www.adobe.com/some-page'
      - 'https://www.adobe.com/another-page'
Audit:
  type: object
  readOnly: true
  properties:
    siteId:
      description: The ID of the site this audit belongs to
      $ref: '#/Id'
    auditedAt:
      description: The date and time of the audit in ISO 8601 format
      $ref: '#/DateTime'
    expiresAt:
      description: The date and time when the audit expires in ISO 8601 format
      $ref: '#/DateTime'
    deliveryType:
      description: The type of the delivery this site is using
      $ref: '#/DeliveryType'
    fullAuditRef:
      description: |
        A reference by which the full external result of an audit can be accessed, which is dependent on the audit type.
      type: string
    auditResult:
      $ref: '#/AuditResult'
    previousAuditResult:
      $ref: '#/AuditResult'
  example:
    siteId: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    auditedAt: '2024-01-20T12:00:00Z'
    expiresAt: '2024-07-20T12:00:00Z'
    auditType: 'cwv'
    isError: false
    deliveryType: 'aem_edge'
    fullAuditRef: 'https://some-audit-system/full-report/1234'
    auditResult:
      someProperty: 'someValue'
    previousAuditResult:
      someProperty: 'somePreviousValue'
AuditResult:
  description: The result of an audit, which is dependent on the audit type.
  oneOf:
    - type: object
      additionalProperties: true
    - type: object
      properties:
        experimentationOpportunities:
          type: array
          description: A list of experimentation opportunities
          items:
            $ref: './schemas.yaml#/ExperimentationOpportunity'
    - type: object
      description: |
        The result of broken-backlinks audit.
      properties:
        brokenBacklinks:
          type: array
          description: A list of broken backlinks.
          items:
            $ref: './schemas.yaml#/BrokenBacklink'
        fullAuditRef:
          description: |
            A reference by which the full external result of an audit can be accessed, which is dependent on the audit type.
          type: string
    - type: array
      description: Information about the provided URLs in the Google index.
      items:
        $ref: './schemas.yaml#/StructuredData'
    - type: object
      description: |
        The result of costs audit.
      properties:
        ahrefs:
          type: object
          properties:
            usedApiUnits:
              description: |
                API units used so far in the current month.
              type: integer
            limitApiUnits:
              description: |
                Limit of API units for the current month.
              type: integer
            fullAuditRef:
              description: |
                A reference by which the full external result of an audit can be accessed, which is dependent on the audit type.
              type: string
    - type: object
      description: The result of CWV audit
      properties:
        cwv:
          type: array
          description: A list of CWV metrics per url.
          items:
            $ref: './schemas.yaml#/CWVResult'
AuditList:
  type: array
  items:
    $ref: './schemas.yaml#/Audit'
CWVResult:
  type: object
  properties:
    url:
      $ref: '#/URL'
    pageviews:
      type: integer
      example: 349900
    lcp:
      type: number
      format: float
      example: 3303.300000000745
    lcpCount:
      type: integer
      example: 4873
    cls:
      type: number
      format: float
      example: 0.0138671875
    clsCount:
      type: integer
      example: 4216
    inp:
      type: integer
      example: 72
    inpCount:
      type: integer
      example: 1952
    ttfb:
      type: number
      format: float
      example: 732.0500007271767
    ttfbCount:
      type: integer
      example: 5678
ExperimentationOpportunity:
  type: object
  readOnly: true
  properties:
    type:
      type: string
      description: Type of the experimentation opportunity
      example: 'generic'
    page:
      type: string
      description: The title of the webpage
      example: 'Retirement Calculator'
    screenshot:
      type: string
      format: url
      description: A URL pointing to the screenshot of the webpage.
      example: "https://space.cat/screenshots/some-cool-page.png"
    trackedPageKPIName:
      type: string
      description: The name of KPI tracked for this experiment.
      example: 'Bounce rate'
    trackedPageKPIValue:
      type: number
      description: The value of KPI tracked for this experiment.
      example: 0.80
    pageviews:
      type: integer
      description: The total number of views this webpage has received
      example: 15000
    samples:
      type: integer
      description: The total number of samples we have for this webpage in RUM
      example: 150
    activeExperiments:
      type: string
      description: The number of active experiments on the webpage, or 'none' if there are no active experiments.
      examples:
        - 'None'
        - '2 active'
    metrics:
      type: array
      description: The metrics for the experimentation opportunity
      items:
        type: object
StructuredData:
  type: object
  readOnly: true
  properties:
    inspectionUrl:
      type: string
      description: The URL that was inspected
    indexStatusResult:
      type: object
      description: Result of the index status analysis.
      properties:
        verdict:
          $ref: '#/Verdict'
        lastCrawlTime:
          $ref: '#/DateTime'
    richResults:
      type: object
      description: Result of the Rich Results analysis. Absent if there are no rich results found.
      properties:
        verdict:
          $ref: '#/Verdict'
        detectedItemTypes:
          type: array
          description: A list of zero or more rich result types detected on this page.
          items:
            type: string
            example: 'Product snippets'
        detectedIssues:
          type: array
          description: A list of zero or more rich results errors detected on this page.
          items:
            type: object
            properties:
              richResultType:
                type: string
                description: Rich Results type detected on this page.
                example: 'Product snippets'
              items:
                type: array
                description: List of Rich Results items that have issues.
                items:
                  type: object
                  properties:
                    name:
                      type: string
                      description: The user-provided name of this item.
                      example: 'Product name'
                    issues:
                      type: array
                      description: A list of rich result issues found for this instance.
                      items:
                        type: object
                        properties:
                          issueMessage:
                            type: string
                            description: Rich Results issue type.
                            example: 'Missing field "image"'
                          severity:
                            type: string
                            description: Severity of this issue.
                            example: 'ERROR'

Verdict:
  type: string
  description: High-level verdict about whether the URL is indexed.
  enum:
    - 'VERDICT_UNSPECIFIED'
    - 'PASS'
    - 'PARTIAL'
    - 'FAIL'
    - 'NEUTRAL'
HoolihanHeaders:
  type: object
  properties:
    x-request-id:
      description: The request ID
      type: array
      items:
        $ref: '#/Id'
    miso-trace-id:
      description: The Miso trace ID
      type: array
      items:
        type: string
    com-adobe-hoolihan-source-partition:
      description: The source partition
      type: array
      items:
        type: string
    com-adobe-hoolihan-source-offset:
      description: The source offset
      type: array
      items:
        type: string
    com-adobe-hoolihan-publish-time:
      description: The time the event was published in milliseconds since the Unix Epoch
      type: array
      items:
        type: string
        example: "1705914000000"
    x-api-key:
      description: The API key of the client which published the original event
      type: array
      items:
        type: string
    com-adobe-hoolihan-publisher:
      description: The publisher of the original event
      type: array
      items:
        type: string
    com-adobe-hoolihan-source-topic:
      description: The topic that the original event was published to
      type: array
      items:
        type: string
    com-adobe-hoolihan-on-behalf-of:
      description: The client ID(s) that the event was forwarded on behalf of
      type: array
      items:
        type: string
    Content-Type:
      description: The content type of the event value
      type: array
      items:
        type: string
        example: "application/json"
HoolihanEventValue:
  type: object
  required:
    - content
    - headers
  properties:
    content:
      description: The JSON payload of the event, encoded as a Base64 string
      type: string
    headers:
      description: Metadata headers included by Hoolihan on each event
      $ref: '#/HoolihanHeaders'
HoolihanEvent:
  type: object
  required:
    - id
    - topic
    - value
    - partition
    - offset
  properties:
    id:
      description: The Hoolihan ID of the event
      type: string
    topic:
      description: The name of the Hoolihan topic that the event was received on
      type: string
    value:
      description: Value of the event, which contains the message payload from the publishing system
      $ref: '#/HoolihanEventValue'
    partition:
      description: The partition index that the event was received on
      type: integer
    offset:
      description: The offset of the event within the partition
      type: integer
  example:
    id: "b7fyJDj1bu5yrt82RxLX89a98a73KSqR4ptC5MRvlEoLshbgAB3emGKdjQleAMyINZcoAkM6cB7ma2aV"
    topic: "example_fulfillment_topic"
    partition: 0
    offset: 1234
    value:
      content: |-
        ewogICAgImV4dGVybmFsX3JlcXVlc3RfaWQiOiAiMTIzNDUiLAogICAgInJlcXVlc3Rvcl9pZCI6ICIxMjM0NTY3ODkw
        QUJDREVGMTIzNDU2NzhAYWRvYmUuY29tIiwKICAgICJvd25lcl9pZCI6ICIxMjM0NTY3ODkwQUJDREVGMTIzNDU2NzhA
        QWRvYmVPcmciLAogICAgInJlcXVlc3RfdHlwZSI6ICJSRUdVTEFSIiwKICAgICJyZXF1ZXN0b3Jfc3lzdGVtIjogIkFB
        VUkiLAogICAgImZ1bGZpbGxtZW50X2lkIjogIjEyMzQ1Njc4OTBhYmNkZWYxMjM0NTY3ODkwYWJjZGVmMTIzNDU2Nzg5
        MGFiY2RlZjEyMzQ1Njc4OTBhYmNkZWYiLAogICAgImNyZWF0ZV9kYXRlIjogIjIwMjQtMDEtMjJUMDk6MjA6MDEuMTIz
        NDVaIiwKICAgICJpdGVtcyI6IFsKICAgICAgICB7CiAgICAgICAgICAgICJleHRlcm5hbF9pdGVtX2lkIjogIjEyMzQ1
        LWFiY2QtMTIzNC0xMjM0LTEyMzQ0MzIxIiwKICAgICAgICAgICAgInF1YW50aXR5IjogIlVOTElNSVRFRCIsCiAgICAg
        ICAgICAgICJvZmZlcl9pZCI6ICIxMjM0NTY3ODkwQUJDREVGMTIzNDU2Nzg5MEFCQ0RFRiIsCiAgICAgICAgICAgICJh
        Y2NlcHRlZF90ZXJtcyI6IHsKICAgICAgICAgICAgICAgICJjb250cmFjdF9pZCI6ICIxMjM0NTY3ODkwQUJDREVGMTIz
        NCIsCiAgICAgICAgICAgICAgICAiYWNjZXB0ZWRfYWdyZWVtZW50IjogIklOSVRJQUwiCiAgICAgICAgICAgIH0sCiAg
        ICAgICAgICAgICJmdWxmaWxsYWJsZV9pdGVtc19jb21wbGV0ZWQiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAg
        ICAgICAgICAgICAgImlkIjogIjEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCIsCiAgICAgICAgICAg
        ICAgICAgICAgImNvZGUiOiAiZHhfZXhhbXBsZV9zb2x1dGlvbiIsCiAgICAgICAgICAgICAgICAgICAgImZ1bGZpbGxt
        ZW50X2RldGFpbHMiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJmdWxmaWxsYWJsZV9lbnRpdHlfcmVzb3VyY2Vf
        bG9jYXRvciI6ICJodHRwczovL2V4YW1wbGUuY29tLzEyMzQ1Njc4OTBBQkNERUYxMjM0NTY3OEBBZG9iZU9yZyIsCiAg
        ICAgICAgICAgICAgICAgICAgICAgICJmdWxmaWxsYWJsZV9lbnRpdHlfcmVzb3VyY2VfbmFtZSI6ICJFeGFtcGxlIFNv
        bHV0aW9uIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAg
        IH0KICAgIF0KfQ==
      headers:
        x-request-id:
          - "123e4567-e89b-12d3-a456-426614174000"
        miso-trace-id:
          - "12345678abcdef12:12345678abcdef12:12345678abcdef12:1"
        com-adobe-hoolihan-source-partition:
          - "0"
        com-adobe-hoolihan-source-offset:
          - "1234"
        com-adobe-hoolihan-publish-time:
          - "1705915000000"
        x-api-key:
          - "example_publisher_client_id"
        com-adobe-hoolihan-publisher:
          - "example_publisher_client_id"
        com-adobe-hoolihan-source-topic:
          - "example_source_topic"
        com-adobe-hoolihan-on-behalf-of:
          - "example_other_client_id"
        Content-Type:
          - "application/json"
HoolihanEvents:
  type: array
  items:
    $ref: '#/HoolihanEvent'
ProcessingStatus:
  type: string
  enum:
    - 'accepted'
    - 'rejected'
  example: 'accepted'
FulfillmentProcessingResults:
  type: array
  items:
    type: object
    required:
      - status
    properties:
      status:
        description: The acceptance status (whether or not the event was accepted for processing)
        $ref: '#/ProcessingStatus'
      requestId:
        description: The request ID
        $ref: '#/Id'
  example:
    - status: 'accepted'
      requestId: '123e4567-e89b-12d3-a456-426614174000'
    - status: 'rejected'
CDNXForwardedHostAlert:
  type: object
  additionalProperties: true
  properties:
    forwardedHost:
      description: value of x-forwarded-host header in the CDN log which trggered the domain discovery alert
      type: string
      example: 'blog.adobe.com, main--blog--adobecom.hlx.live, main--blog--adobecom.hlx.live, main--blog--adobecom.hlx-fastly.page'
RUMDomainDiscoveryAlert:
  type: object
  additionalProperties: true
  properties:
    url:
      description: URL of the page which triggered the domain discovery alert
      $ref: '#/URL'
    domain:
      description: Domain of the page which triggered the domain discovery alert
      $ref: '#/Domain'
SlackInviteToChannelByUserIdRequest:
  type: object
  required:
    - imsOrgId
    - imsUserAccessToken
  properties:
    imsOrgId:
      description: The ID of the Adobe IMS organization
      $ref: '#/ImsOrganizationId'
    imsUserAccessToken:
      description: The IMS access token of the user to invite to the Slack channel
      $ref: '#/ImsUserAccessToken'
Configuration:
  type: object
  properties:
    version:
      type: string
      readOnly: true
      description: Internal version of the configuration, managed and incremented by the system. Not exposed for external control via the API.
    jobs:
      type: array
      items:
        $ref: '#/Job'
      description: A list of job configurations, detailing job type, its group, and execution interval.
    queues:
      type: object
      properties:
        audits:
          type: string
          format: url
          description: The SQS queue name for audit jobs
        imports:
          type: string
          format: url
          description: The SQS queue name for import jobs
        reports:
          type: string
          format: url
          description: The SQS queue name for report jobs
Job:
  type: object
  properties:
    group:
      type: string
      description: The group or category to which the job belongs, helping in organizing jobs by their functional area.
    interval:
      type: string
      description: Specifies how often the job should run, e.g., 'daily'. This is part of job scheduling information.
    type:
      type: string
      description: The job type, indicating the specific action or task that the job performs, such as 'rum-to-aa' indicating a data import job from RUM to AA.
AnalyticsSiteIntegration:
  type: object
  additionalProperties: true
  required:
    - siteId
    - reporting
    - dataCollection
    - dataStore
    - dataMapping
  properties:
    siteId:
      description: The site ID in uuid format
      $ref: '#/Id'
    reporting:
      description: The reporting details
      type: object
      required:
        - link
      additionalProperties: true
      properties:
        link:
          description: |
            The link to the report in the reporting tool.
            For Adobe Analytics and Customer Journey Analytics, the link to the Analysis Workspace report.
          $ref: '#/URL'
        timezone:
          description: The timezone for the data in the report
          type: string
    dataCollection:
      description: The configuration for the data collection to embed on the site.
      type: object
      required:
        - type
        - environments
      properties:
        type:
          description: The type of the data collection
          type: string
          enum:
            - 'adobe-tags'
            - 'aep-websdk'
        environments:
          description: |
            The environments for the data collection script.
            At least the script for the production environment is required.
            The keys represent the environments (development, staging, production).
            The values represent the URL or ID of the data collection script.
            For Adobe Analytics and Customer Journey Analytics, the values are either
            URL for the Adobe Launch script or the datastream ID.
          type: object
          additionalProperties:
            type: string
          required:
            - production
          properties:
            production:
              description: The URL or ID of the production data collection script
              type: string
    dataStore:
      description: The data store details
      type: object
      required:
        - id
        - type
      additionalProperties: true
      properties:
        id:
          description: The ID of the data store
          type: string
        type:
          description: The type of the data store
          type: string
          enum:
            - 'adobe-analytics'
            - 'aep'
    dataSchema:
      description: The data schema details
      type: object
      required:
        - id
      additionalProperties: true
      properties:
        id:
          description: The ID of the data schema
          type: string
    dataMapping:
      description: The data mapping details
      type: object
      required:
        - type
        - mappings
      properties:
        type:
          description: The type of the data mapping
          type: string
          enum:
            - 'adobe-analytics'
            - 'xdm'
        mappings:
          description: |
            The data mapping details. The keys represent human-friendly naming of metrics and dimensions captured by the
            instrumentation of the site. The values represent the corresponding metric and dimension names in the data store.
            For Adobe Analytics, the values are either evars or events.
            For XDM, the values are the paths in the data schema.
          type: object
          additionalProperties:
            type: string
  examples:
    - analytics-site-integration-aa-tags:
        $ref: './examples.yaml#/analytics-site-integration-aa-tags'
    - analytics-site-integration-aa-aep-websdk:
        $ref: './examples.yaml#/analytics-site-integration-aa-aep-websdk'
    - analytics-site-integration-cja-tags:
        $ref: './examples.yaml#/analytics-site-integration-cja-tags'
    - analytics-site-integration-cja-websdk:
        $ref: './examples.yaml#/analytics-site-integration-cja-websdk'
KeyEventType:
  type: string
  enum:
    - 'performance'
    - 'seo'
    - 'content'
    - 'code'
    - 'third party'
    - 'experimentation'
    - 'network'
    - 'status change'
KeyEvent:
  type: object
  properties:
    id:
      description: The key event ID in uuid format
      $ref: '#/Id'
    name:
      description: Name of the key event
      type: string
    type:
      $ref: '#/KeyEventType'
    time:
      description: Time of the key event occurred
      $ref: '#/DateTime'
  example:
    id: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    name: 'Multiple 404s detected'
    type: 'seo'
    time: '2023-12-15T09:30:00Z'
KeyEventsList:
  type: array
  items:
    $ref: './schemas.yaml#/KeyEvent'
KeyEventCreate:
  type: object
  required:
    - name
    - type
  properties:
    name:
      description: Name of the key event
      type: string
    type:
      $ref: '#/KeyEventType'
    time:
      description: Time of the key event occurred (optional). Current time is used when the field is missing
      $ref: '#/DateTime'
SiteTopPage:
  type: object
  required:
    - siteId
    - url
    - traffic
    - source
    - geo
    - importedAt
  properties:
    siteId:
      description: The site ID in uuid format
      $ref: '#/Id'
    url:
      description: The URL of the top page
      $ref: '#/URL'
    traffic:
      description: The traffic of the top page
      type: integer
    source:
      description: The source of the top page listing
      type: string
    geo:
      description: The geo of the top page listing, or 'global' if not specific to a geo
      type: string
    importedAt:
      description: The date and time when the top page was imported
      $ref: '#/DateTime'
  example:
    siteId: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    url: 'https://example-site.com/foo/bar'
    traffic: 360420000
    source: 'ahrefs'
    geo: 'au'
    importedAt: '2024-04-29T15:14:33.653Z'
SiteTopPageList:
  type: array
  items:
    $ref: './schemas.yaml#/SiteTopPage'
SiteExperimentVariant:
  type: object
  properties:
    name:
      description: The name of the variant
      type: string
    label:
      description: The label of the variant
      type: string
    split:
      description: The split allocation of the traffic to the variant
      type: number
    url:
      description: The url of the variant
      $ref: '#/URL'
    views:
      description: The number of views for the variant
      type: integer
    samples:
      description: The number of data points (samples) used for this variant
      type: integer
    interactionsCount:
      description: The interactions count for the variant
      type: integer
    p_value:
      description: The p-value of the variant for the configured metric or clicks
      type: number
    power:
      description: The power of the variant for the configured metric or clicks
      type: number
    statsig:
      description: The statistical significance of the variant based on the configured metric or clicks
      type: boolean
    metrics:
      description: The metrics for the variant
      type: array
      items:
        type: object
        properties:
          selector:
            description: The css selector of the element on which the interaction was performed
            type: string
          value:
            description: The value of the metric on the selector
            type: number
          samples:
            description: The number of data points (samples) used for calculating this metric object
            type: integer
          type:
            description: The type of the metric
            type: string
            enum:
              - 'click'
              - 'convert'
              - 'formsubmit'
  example:
    name: 'challenger-1'
    label: 'Challenger 1'
    split: 0.5
    url: 'https://example-site.com/foo/bar'
    views: 1000
    samples: 10
    interactionsCount: 200
    p_value: 0.04
    power: 97.6
    statsig: true
    metrics:
      - selector: '.add-to-cart'
        value: 300
        samples: 3
        type: 'click'
SiteExperiment:
  type: object
  properties:
    siteId:
      description: The site ID in uuid format
      $ref: '#/Id'
    experimentId:
      description: The ID of the experiment
      type: string
    name:
      description: The name of the experiment
      type: string
    url:
      description: The URL of the experiment
      $ref: '#/URL'
    status:
      description: The status of the experiment
      type: string
      enum:
        - 'ACTIVE'
        - 'COMPLETE'
        - 'INACTIVE'
    type:
      description: The type of the experiment
      type: string
      enum:
        - 'FULL'
        - 'AB'
        - 'MAB'
    startDate:
      description: The start date and time of the experiment
      $ref: '#/DateTime'
    endDate:
      description: The end date and time of the experiment
      $ref: '#/DateTime'
    variants:
      description: The variants of the experiment
      type: array
      items:
        $ref: './schemas.yaml#/SiteExperimentVariant'
    updatedAt:
      description: The date and time when the experiment was last updated
      $ref: '#/DateTime'
    updatedBy:
      description: The user/entity who last updated the experiment
      type: string
    conversionEventName:
      description: The name of the conversion event
      type: string
    conversionEventValue:
      description: The name of conversion event value
      type: string
  example:
    siteId: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    experimentId: '1012-home-page-optimization'
    name: '1012 Home Page Optimization'
    url: 'https://example-site.com/foo/bar'
    type: 'AB'
    status: 'ACTIVE'
    startDate: '2024-04-29T15:14:33.653Z'
    endDate: '2024-05-29T15:14:33.653Z'
    variants:
      - name: 'challenger-1'
        label: 'Challenger 1'
        split: 0.5
        url: 'https://example-site.com/foo/bar'
        views: 1000
        samples: 10
        interactionsCount: 200
        p_value: 0.04
        power: 97.6
        statsig: true
        metrics:
          - selector: '.add-to-cart'
            value: 300
            samples: 3
            type: 'click'
    updatedAt: '2024-05-31T15:14:33.653Z'
    updatedBy: 'admin'
    conversionEventName: 'click'
    conversionEventValue: '.add-to-cart'
SiteExperimentList:
  type: array
  items:
    $ref: './schemas.yaml#/SiteExperiment'
SiteMetric:
  type: object
  required:
    - siteId
    - source
    - metric
    - value
    - time
  properties:
    siteId:
      description: The site ID in uuid format
      $ref: '#/Id'
    source:
      description: The source for retrieving the metric value
      type: string
    name:
      description: The name of the metric
      type: string
    value:
      description: The value of the metric
      type: integer
    time:
      description: The date and time when the metric was recorded
      $ref: '#/DateTime'
  example:
    siteId: 'a1b2c3d4-e5f6-7g8h-9i0j-k11l12m13n14'
    source: 'ahrefs'
    name: 'organic-traffic'
    value: 37900
    time: '2024-04-29T00:00:00.000Z'
SiteMetricList:
  type: array
  items:
    $ref: './schemas.yaml#/SiteMetric'
ImportOptions:
  type: object
  properties:
    pageLoadTimeoutMs:
      description: The time in milliseconds to wait for the page to load
      type: integer
    enableJavascript:
      description: Whether to enable JavaScript on the page
      type: boolean
    scrollToBottom:
      description: Whether to scroll to the bottom of the page
      type: boolean
    customHeaders:
      description: Custom headers to send with each HTTP request
      type: object
      additionalProperties: true
  example:
    pageLoadTimeoutMs: 100
    enableJavaScript: true
    scrollToBottom: true
    customHeaders:
      example-header-name: 'example-header-value'
ImportJobRequest:
  type: object
  required:
    - urls
  properties:
    urls:
      description: The URLs to import
      type: array
      items:
        $ref: '#/URL'
    options:
      description: Optional configuration params, defined as a JSON object
      $ref: '#/ImportOptions'
    importScript:
      description: Optional import.js mapping file
      type: string
      format: base64
  example:
    urls:
      - 'https://example.com/en/page1'
      - 'https://example.com/fr/page2'
    options:
      enableJavascript: true
      scrollToBottom: true
ImportJobStatus:
  type: object
  properties:
    id:
      description: The ID of the import job
      $ref: '#/Id'
    status:
      description: The status of the import job
      type: string
      enum:
        - 'RUNNING'
        - 'COMPLETE'
        - 'FAILED'
    startTime:
      description: The date and time when the import job started
      $ref: '#/DateTime'
    endTime:
      description: The date and time when the import job ended, if finished
      $ref: '#/DateTime'
    urlCount:
      description: The total number of URLs in the job
      type: integer
    successCount:
      description: The number of URLs successfully imported
      type: integer
    failedCount:
      description: The number of URLs that failed to import
      type: integer
  example:
    id: '12d6ac8e-d5e4-4788-90eb-b69e10e745fd'
    status: 'RUNNING'
    startTime: '2024-01-19T14:20:30Z'
    urlCount: 25
    successCount: 15
    failedCount: 0
ImportJobArchive:
  type: object
  properties:
    jobId:
      description: The ID of the import job
      $ref: '#/Id'
    downloadUrl:
      description: The pre-signed URL to download the archive of the import job
      $ref: '#/URL'
  example:
    jobId: '12d6ac8e-d5e4-4788-90eb-b69e10e745fd'
    downloadUrl: 'https://spacecat-example-bucket.s3.example-region.amazonaws.com/import/12d6ac8e-d5e4-4788-90eb-b69e10e745fd/import-result.zip?X-Amz-Algorithm=AWS...'
ScrapeRequest:
  type: object
  required:
    - urls
  properties:
    urls:
      description: The URLs to scrape. The URLs must be unique. Limit of 10 URLs per request.
      type: array
      items:
        $ref: '#/URL'
      example:
        - 'https://example.com/en/page1'
        - 'https://example.com/fr/page2'
ScrapeResponse:
  type: object
  properties:
    id:
      description: The ID of the scrape job
      $ref: '#/Id'
    status:
      description: The status of the scrape job
      type: string
      enum:
        - 'COMPLETE'
        - 'FAILED'
    startTime:
      description: The date and time when the scrape job started
      $ref: '#/DateTime'
    endTime:
      description: The date and time when the scrape job ended, if finished
      $ref: '#/DateTime'
    urlCount:
      description: The total number of URLs in the job
      type: integer
    successCount:
      description: The number of URLs successfully scraped
      type: integer
    failedCount:
      description: The number of URLs that failed to scrape
      type: integer
    results:
      description: The scrape results
      type: array
      items:
        $ref: '#/ScrapeResult'
  example:
    id: '12d6ac8e-d5e4-4788-90eb-b69e10e745fd'
    status: 'COMPLETE'
    startTime: '2024-01-19T14:20:30Z'
    urlCount: 10
    successCount: 9
    failedCount: 1
    results:
      - url: 'https://example.com/en/page1'
        status: 'COMPLETE'
        content: '...'
      - url: 'https://example.com/fr/page2'
        status: 'FAILED'
        error: '...'
ScrapeResult:
  type: array
  items:
    type: object
    properties:
      url:
        description: The URL of the scraped page
        $ref: '#/URL'
      status:
        description: The status of the scrape job
        type: string
        enum:
          - 'COMPLETE'
          - 'FAILED'
      content:
        description: The content of the scraped page
        type: string
      error:
        description: The error message if the scrape failed
        type: string
    example:
      - url: 'https://example.com/en/page1'
        status: 'COMPLETE'
        content: '<body>...</body>'
      - url: 'https://example.com/fr/page2'
        status: 'FAILED'
        error: 'Timeout'
BrokenBacklink:
  type: object
  properties:
    url_to:
      description: The URL of the broken link.
      $ref: '#/URL'
    title:
      description: The title of the page referring to the broken link.
      type: string
    url_from:
      description: The URL of the page referring to the broken link.
      $ref: '#/URL'
    traffic_domain:
      description: The referring domain's estimated monthly organic traffic from search.
      type: number
    url_suggested:
      description: The URL suggested for redirecting from the broken backlink.
      $ref: '#/URL'
